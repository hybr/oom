-- =====================================================================
-- RETURN & REFUND WORKFLOW - Handle customer returns and refunds
-- From return request to refund processing
-- Generated: 2025-11-10
-- =====================================================================

PRAGMA foreign_keys = ON;

INSERT OR IGNORE INTO process_graph (
    id, code, name, description, entity_id, version_number,
    is_active, is_published, category, created_at
) VALUES (
    'RETN0000-RFND-4111-W111-000000000001',
    'RETURN_REFUND_WORKFLOW',
    'Product Return & Refund Process',
    'Handle customer returns and refund processing',
    'o1r1d1e1-r000-4111-a111-111111111111',  -- ORDER entity
    1, 1, 1, 'MARKETPLACE_COMMERCE', datetime('now')
);

-- Nodes
INSERT OR IGNORE INTO process_node (id, graph_id, node_code, node_name, node_type, description, position_id, permission_type_id, sla_hours, display_x, display_y, created_at) VALUES
('RETN0001-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'START', 'Start', 'START', 'Customer initiates return', NULL, NULL, NULL, 100, 100, datetime('now')),
('RETN0002-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'REQUEST_RETURN', 'Request Return', 'TASK', 'Customer submits return request', NULL, NULL, 48, 200, 100, datetime('now')),
('RETN0003-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'REVIEW_ELIGIBILITY', 'Review Eligibility', 'TASK', 'Check return policy compliance', NULL, NULL, 12, 300, 100, datetime('now')),
('RETN0004-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'APPROVE_RETURN', 'Approve Return', 'TASK', 'Approve or reject return request', NULL, NULL, 24, 400, 100, datetime('now')),
('RETN0005-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'GENERATE_LABEL', 'Generate Shipping Label', 'TASK', 'Create return shipping label', NULL, NULL, 4, 500, 100, datetime('now')),
('RETN0006-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RECEIVE_ITEM', 'Receive Returned Item', 'TASK', 'Receive and log returned item', NULL, NULL, 168, 600, 100, datetime('now')),
('RETN0007-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'INSPECT_ITEM', 'Inspect Item Condition', 'TASK', 'Inspect returned item quality', NULL, NULL, 12, 700, 100, datetime('now')),
('RETN0008-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'PROCESS_REFUND', 'Process Refund/Exchange', 'TASK', 'Issue refund or exchange', NULL, NULL, 24, 800, 100, datetime('now')),
('RETN0009-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'UPDATE_INVENTORY', 'Update Inventory', 'TASK', 'Restore inventory if applicable', NULL, NULL, 4, 900, 100, datetime('now')),
('RETN0010-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'CLOSE_CASE', 'Close Return Case', 'TASK', 'Finalize and close return case', NULL, NULL, 2, 1000, 100, datetime('now')),
('RETN0011-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'END', 'End', 'END', 'Return process complete', NULL, NULL, NULL, 1100, 100, datetime('now'));

-- Edges
INSERT OR IGNORE INTO process_edge (id, graph_id, from_node_id, to_node_id, edge_label, edge_order, completion_action, created_at) VALUES
('RETNE001-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0001-RFND-4111-W111-000000000001', 'RETN0002-RFND-4111-W111-000000000001', 'Begin', 1, NULL, datetime('now')),
('RETNE002-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0002-RFND-4111-W111-000000000001', 'RETN0003-RFND-4111-W111-000000000001', 'Submitted', 1, 'COMPLETE', datetime('now')),
('RETNE003-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0003-RFND-4111-W111-000000000001', 'RETN0004-RFND-4111-W111-000000000001', 'Eligible', 1, 'COMPLETE', datetime('now')),
('RETNE004-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0004-RFND-4111-W111-000000000001', 'RETN0005-RFND-4111-W111-000000000001', 'Approved', 1, 'APPROVE', datetime('now')),
('RETNE005-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0004-RFND-4111-W111-000000000001', 'RETN0011-RFND-4111-W111-000000000001', 'Rejected', 2, 'REJECT', datetime('now')),
('RETNE006-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0005-RFND-4111-W111-000000000001', 'RETN0006-RFND-4111-W111-000000000001', 'Label Sent', 1, 'COMPLETE', datetime('now')),
('RETNE007-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0006-RFND-4111-W111-000000000001', 'RETN0007-RFND-4111-W111-000000000001', 'Received', 1, 'COMPLETE', datetime('now')),
('RETNE008-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0007-RFND-4111-W111-000000000001', 'RETN0008-RFND-4111-W111-000000000001', 'Inspected', 1, 'COMPLETE', datetime('now')),
('RETNE009-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0008-RFND-4111-W111-000000000001', 'RETN0009-RFND-4111-W111-000000000001', 'Refunded', 1, 'COMPLETE', datetime('now')),
('RETNE010-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0009-RFND-4111-W111-000000000001', 'RETN0010-RFND-4111-W111-000000000001', 'Inventory Updated', 1, 'COMPLETE', datetime('now')),
('RETNE011-RFND-4111-W111-000000000001', 'RETN0000-RFND-4111-W111-000000000001', 'RETN0010-RFND-4111-W111-000000000001', 'RETN0011-RFND-4111-W111-000000000001', 'Case Closed', 1, 'COMPLETE', datetime('now'));
